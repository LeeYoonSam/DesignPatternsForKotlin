# 플라이웨이트(Flyweight) 패턴

## 설명
플라이웨이트 패턴은 구조적(Structural) 디자인 패턴으로, 많은 수의 유사한 객체를 효율적으로 관리하기 위해 객체의 내부 상태를 공유하여 메모리 사용량을 줄이는 패턴입니다. 대량의 객체를 생성해야 하고 각 객체의 일부 상태가 공통적일 때 사용합니다.

## 문제점
게임이나 시뮬레이션에서 수천 또는 수만 개의 파티클(입자)을 생성해야 하는 경우, 각 파티클마다 개별 객체를 생성하면 메모리 사용량이 급증합니다. 특히 파티클의 텍스처, 모양, 행동 패턴과 같은 많은 속성이 여러 파티클 간에 동일한 경우에도 중복해서 메모리를 사용하게 됩니다.

예를 들어, 폭발 효과에서 수백 개의 불꽃 파티클을 생성한다고 가정해보면:
- 각 파티클은 위치, 속도, 수명과 같은 고유한 상태를 가집니다.
- 하지만 텍스처, 렌더링 방식, 물리적 특성 등은 모든 불꽃 파티클에서 동일합니다.

이런 상황에서 모든 파티클마다 중복된 정보를 저장하는 것은 메모리 낭비가 됩니다.

## 플라이웨이트 패턴의 주요 장점
- **메모리 효율성**: 공유 가능한 상태를 분리하여 메모리 사용량을 크게 줄입니다.
- **성능 개선**: 객체 생성 수를 줄여 시스템의 전반적인 성능이 향상됩니다.
- **확장성**: 더 많은 객체를 효율적으로 처리할 수 있어 시스템의 확장성이 높아집니다.
- **관리 용이성**: 공유 상태의 중앙 관리가 가능해 유지보수가 용이합니다.

## 주요 구성 요소
1. **Flyweight(플라이웨이트)**: 공유될 수 있는 상태를 포함하는 인터페이스나 클래스
2. **Concrete Flyweight(구체적인 플라이웨이트)**: Flyweight 인터페이스를 구현하는 클래스
3. **Flyweight Factory(플라이웨이트 팩토리)**: Flyweight 객체를 생성하고 관리하는 팩토리 클래스
4. **Client(클라이언트)**: Flyweight 객체를 사용하는 클라이언트 코드

## 실제 활용 사례
- **게임 개발**: 동일한 모델, 텍스처를 공유하는 게임 오브젝트(나무, 적 캐릭터 등)
- **텍스트 편집기**: 동일한 글꼴, 스타일을 가진 문자들
- **그래픽 애플리케이션**: 반복되는 이미지 요소나 도형 처리
- **웹 애플리케이션**: 공통된 리소스나 설정을 공유하는 사용자 세션

## 주의사항
- 플라이웨이트 패턴은 공유 상태와 고유 상태를 명확히 구분할 수 있는 경우에만 효과적입니다.
- 스레드 안전성을 고려해야 합니다. 공유 객체는 여러 컨텍스트에서 동시에 사용될 수 있습니다.
- 너무 복잡한 시스템에서는 오히려 관리가 어려워질 수 있습니다.

## 결론
플라이웨이트 패턴은 대량의 유사한 객체를 효율적으로 관리해야 하는 시스템에서 매우 유용합니다. 이 패턴을 통해 객체 내의 데이터를 내부 상태(공유 가능)와 외부 상태(고유)로 구분하여 메모리 사용을 최적화할 수 있습니다. 파티클 시스템과 같이 많은 유사 객체를 다루는 게임이나 그래픽 애플리케이션에서 특히 중요한 패턴입니다.