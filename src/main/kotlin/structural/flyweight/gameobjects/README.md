# 플라이웨이트 패턴

## 설명

플라이웨이트 패턴은 구조적 디자인 패턴으로, 다수의 유사 객체를 효율적으로 공유함으로써 메모리 사용을 최적화합니다. 이 패턴은 객체의 내부 상태를 '공유 가능한 내부 상태(intrinsic state)'와 '상황에 따라 변하는 외부 상태(extrinsic state)'로 분리합니다.

## 문제점

게임 개발에서 흔히 발생하는 문제 중 하나는 수많은 게임 객체(적 캐릭터, 나무, 풀 등)를 생성할 때 발생하는 메모리 부담입니다. 예를 들어 전투 게임에서 수백 개의 동일한 적 캐릭터를 생성할 경우:

1. 모든 적 캐릭터가 동일한 텍스처, 메쉬, 애니메이션 등을 개별적으로 저장하면 메모리가 낭비됩니다.
2. 객체 생성 및 가비지 컬렉션에 따른 성능 저하가 발생합니다.
3. 로딩 시간이 길어집니다.

## 플라이웨이트 패턴의 주요 장점

1. **메모리 사용량 감소**: 공통 데이터를 공유함으로써 메모리 사용량을 대폭 줄일 수 있습니다.
2. **성능 향상**: 객체 생성 비용이 감소하고, 캐시 효율성이 향상됩니다.
3. **확장성**: 더 많은 객체를 효율적으로 관리할 수 있어 게임의 규모와 복잡성을 확장할 수 있습니다.
4. **로딩 시간 단축**: 중복 데이터 로딩이 줄어 초기 로딩 시간이 단축됩니다.

## 주요 구성 요소

1. **Flyweight**: 공유 가능한 상태를 포함하는 인터페이스나 클래스입니다.
2. **ConcreteFlyweight**: Flyweight 인터페이스를 구현하며, 공유 가능한 내부 상태를 저장합니다.
3. **FlyweightFactory**: Flyweight 객체를 생성하고 관리하는 팩토리 클래스입니다.
4. **Client**: 플라이웨이트 객체를 사용하고 필요한 외부 상태를 제공합니다.

## 실제 활용 사례

1. **게임 개발**: 동일한 외형을 가진 다수의 게임 객체(적 캐릭터, 나무, 건물 등)
2. **텍스트 에디터**: 문자 서식(폰트, 색상, 크기 등)
3. **지도 애플리케이션**: 지도 타일, 아이콘 등
4. **그래픽 응용 프로그램**: 벡터 그래픽 객체, 텍스처 등

## 주의사항

1. **외부 상태 관리**: 외부 상태를 효율적으로 관리해야 합니다.
2. **스레드 안전성**: 공유 객체를 다룰 때 동시성 문제가 발생할 수 있습니다.
3. **변경 불가능성**: 공유 객체는 가급적 불변이어야 합니다.
4. **적용 대상 선택**: 메모리 소비가 큰 객체에 집중적으로 적용해야 합니다.

## 결론

플라이웨이트 패턴은 대량의 유사 객체를 다루는 게임 개발에서 메모리 사용을 최적화하고 성능을 향상시킬 수 있는 강력한 도구입니다. 공유 가능한 데이터를 분리하고 재사용함으로써 시스템의 확장성과 효율성을 높일 수 있습니다.
