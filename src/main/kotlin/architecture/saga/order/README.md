# Saga 패턴

## 설명
Saga 패턴은 분산 시스템에서 장기 실행 트랜잭션을 관리하기 위한 디자인 패턴입니다. 각 트랜잭션은 로컬 트랜잭션들의 시퀀스로 구성되며, 각 로컬 트랜잭션은 자체 보상 트랜잭션을 가집니다.

## 문제점
분산 시스템에서 발생하는 트랜잭션 관리의 어려움:
1. **일관성 유지**
    - 여러 서비스에 걸친 트랜잭션 관리
    - 부분 실패 처리의 복잡성

2. **원자성 보장**
    - 분산 환경에서 ACID 트랜잭션 불가능
    - 롤백 처리의 어려움

3. **서비스 간 결합**
    - 강한 결합도로 인한 유지보수 어려움
    - 확장성 제한

## Saga 패턴의 주요 장점
1. **분산 트랜잭션 관리**
    - 마이크로서비스 간 트랜잭션 조율
    - 느슨한 결합 유지

2. **결과적 일관성**
    - 보상 트랜잭션을 통한 롤백 보장
    - 비즈니스 규칙 준수

3. **확장성**
    - 독립적인 서비스 스케일링 가능
    - 새로운 서비스 추가 용이

## 주요 구성 요소
1. **Saga 오케스트레이터**
    - 트랜잭션 순서 관리
    - 실패 시 보상 트랜잭션 조율

2. **로컬 트랜잭션**
    - 각 서비스의 독립적인 트랜잭션
    - 자체 데이터 일관성 유지

3. **보상 트랜잭션**
    - 실패 시 롤백 처리
    - 이전 상태로 복원

4. **이벤트**
    - 서비스 간 통신 매개체
    - 트랜잭션 상태 전파

## 구현 방식
1. **코레오그래피(Choreography) 방식**
    - 이벤트 기반 통신
    - 분산된 의사 결정
    - 서비스 자율성 높음

2. **오케스트레이션(Orchestration) 방식**
    - 중앙 조정자 존재
    - 명확한 제어 흐름
    - 모니터링 용이

## 실제 활용 사례
1. **전자상거래**
    - 주문 처리
    - 결제 시스템
    - 재고 관리

2. **여행 예약**
    - 항공권 예약
    - 호텔 예약
    - 렌터카 예약

3. **금융 거래**
    - 송금 처리
    - 계좌 관리
    - 투자 처리

## 주의사항
1. **복잡성 관리**
    - 보상 트랜잭션 설계의 복잡성
    - 디버깅의 어려움

2. **일관성 모델**
    - 일시적 불일치 허용
    - 비즈니스 요구사항 고려

3. **오류 처리**
    - 장애 상황 대비
    - 멱등성 보장

## 결론
Saga 패턴은 분산 시스템에서 복잡한 트랜잭션을 관리하는 효과적인 방법을 제시